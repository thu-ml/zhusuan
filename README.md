# ZhuSuan

ZhuSuan is a python	library	for	**Generative Models**, built upon Tensorflow.
Unlike existing deep learning libraries, which are mainly designed for
supervised tasks, ZhuSuan is featured for its deep root into Bayesian
Inference, thus supporting various kinds of generative models: both the
traditional **hierarchical Bayesian models** and recent
**deep generative models**.

With ZhuSuan, users can enjoy powerful fitting and multi-GPU training of deep
learning, while at the same time they can use generative models to model the
complex world, exploit unlabeled data and deal with uncertainty by performing
principled Bayesian inference.

## Supported Inference
### (Stochastic) Variational Inference (VI & SVI)
* Kinds of variational posteriors we support:
  * __Mean-field__ posterior: Fully-factorized.
  * __Structured__ posterior: With user specified dependencies.

* Variational objectives we support:
  * __SGVB__: Stochastic gradient variational Bayes
  * __IWAE__: Importance weighted objectives
  * __NVIL__: Score function estimator with variance reduction
  * __VIMCO__: Multi-sample score function estimator with variance reduction

### Adaptive Importance Sampling
* Reweighted Wake-sleep (__RWS__): With user specified adaptive proposal.

### Markov Chain Monte Carlo (MCMC)
* Hamiltonian Monte Carlo (__HMC__): With step size and mass adaptation.

## Installation

ZhuSuan is still under development. Before the first stable release (1.0),
please clone the repository and run

`pip install .`

in the main directory. This will install ZhuSuan and its dependencies 
automatically. 

If you are developing ZhuSuan, you may want to install in an 
"editable" or "develop" mode. See the Developments section below.

## Examples

To run the provided examples, you may need extra dependencies to be installed.
This can be done by

`pip install .[examples]`

* Gaussian: 
[HMC](examples/toy_examples/gaussian.py)
* Toy 2D Intractable Posterior: 
[SGVB](examples/toy_examples/toy2d.py)
* Beyesian Neural Networks: 
[SGVB](examples/bayesian_neural_nets/bayesian_nn.py)
* Variational Autoencoder (VAE): 
[SGVB](examples/variational_autoencoders/vae.py), 
[IWAE](examples/variational_autoencoders/iwae.py)
* Convolutional VAE: 
[SGVB](examples/variational_autoencoders/vae_conv.py)
* Semi-supervised VAE (Kingma, 2014): 
[SGVB](examples/semi_supervised_vae/vae_ssl.py),
[RWS](examples/semi_supervised_vae/vae_ssl_rws.py)
* Deep Sigmoid Belief Networks
[RWS](examples/sigmoid_belief_nets/sbn_rws.py),
[VIMCO](examples/sigmoid_belief_nets/sbn_vimco.py)
* Logistic Normal Topic Model: 
[HMC](examples/topic_models/lntm_mcem.py)

## Developments

To install ZhuSuan in an "editable" or "develop" mode, run

`pip install -e .`

in the main directory. This installation is removable by

`python setup.py develop --uninstall`

### Tests
This command will run automatic tests in the main directory.

`python -m unittest discover -v`

##### Test Coverage
After running tests, to ensure test coverage keeping 100% over the 
developments, run

`coverage report --include="zhusuan/*"`

##### PEP8 Code Style Check
We follow PEP8 python code style. To check, in the main directory, run

`pep8 .`

### Docs

Docs are written under `docs/` directory as RestructuredText (`.rst`) files.
`index.rst` is the main page. A Tutorial on RestructuredText can be found 
[here](https://pythonhosted.org/an_example_pypi_project/sphinx.html).

API References are automatically generated by 
[Sphinx](http://www.sphinx-doc.org/en/stable/). They are under `doc/api/` 
directory and should be regenerated each time when any code changes:

`make api`

To compile docs into webpages, Run

`make html`

under `docs/` directory. The generated webpages are in `docs/_build` and
can be viewed with browsers.
